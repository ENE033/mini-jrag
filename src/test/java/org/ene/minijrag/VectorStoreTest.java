package org.ene.minijrag;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import org.ene.minijrag.client.ElasticsearchClient;
import org.ene.minijrag.req.VectorDocumentReq;
import org.springframework.boot.SpringApplication;
import org.springframework.context.ConfigurableApplicationContext;
import reactor.core.publisher.Mono;

import java.util.ArrayList;
import java.util.List;

public class VectorStoreTest {
    public static void main(String[] args) {
        String text = """
                [{
                		"object": "embedding",
                		"index": 0,
                		"embedding": [-0.01609608, -0.051613674, 0.05941603, 0.010422374, 0.08162693, -0.05726691, 0.088645086, 0.10869694, -0.05774339, -0.11343195, 0.05163353, 0.0021305096, 0.044049557, -0.1975604, -0.12515534, 0.029221607, -0.06576413, 0.03146007, -0.015016489, 7.364341E-4, -0.09262071, 0.047012668, 0.05554463, -0.041240316, -0.024537465, -0.015687848, 0.08635203, -0.07106497, -0.14072034, -0.013268224, 0.0115676625, -0.027841803, 0.024147844, -0.0726433, 0.0052418974, 0.086272605, 0.0013739119, 0.05457182, -0.09087858, 0.0022336345, 0.082788356, -0.12462923, -0.025461886, 0.029489629, 0.044526037, 0.04267968, -0.037344098, -0.019365674, -0.04151826, 0.062086303, -0.023742711, 0.05595659, -0.045488924, -3.395228E-4, 0.01763231, 0.05083443, 0.014697663, -0.014753113, 0.050328173, -0.05095355, 0.0152448695, -0.053301208, -0.12913594, -0.024438199, 0.01750815, 0.03905645, -0.065813765, 0.007956995, 0.03350993, -0.03431647, 0.06597259, 0.09557389, -0.039915103, 0.07125357, -0.0145481415, -0.01824272, 0.07315949, -5.546522E-4, -0.0021999963, 0.02046257, 0.01863048, -0.0071347877, 0.0177954, -0.030189458, 0.00490284, -0.041079625, -0.032857247, 0.001923911, -0.06863294, 0.009966368, 0.06749137, 0.0076149898, 0.04329513, -0.05260634, 0.028350545, -0.0132967625, -0.021882083, 0.051166974, 0.011516167, 0.042362027, 0.031827357, 0.0015411141, -0.034214716, 0.10751566, -0.04903026, -0.0027490647, 0.094074965, 0.013976739, -0.10389243, -0.03827224, 8.121249E-4, 0.0037470043, 0.032673605, 0.011894932, 0.028624149, -0.029943772, 0.06148077, -0.005338062, 0.076743014, -0.045230832, -0.0038288995, -0.08047544, -0.014232039, 0.0054913047, 6.2724086E-4, -0.04167212, -0.021010399, 0.04852152, 0.04114353, -0.023260647, 0.038637046, 0.010435402, 0.0152374245, -0.0067145326, -0.046288017, 0.021674864, 0.041513298, 0.022014853, -0.006067051, 0.020807523, 0.049648196, 0.012905125, -0.07521431, 0.018312208, 0.056567077, -0.03502126, -0.010769187, 0.0016881528, 0.033043373, -0.030510522, -0.023347275, 0.017818978, -0.0046543633, 0.0019382582, -0.0012203589, 0.03980095, 0.020427518, -0.03511308, 0.042264, -0.014214358, -0.032509815, -0.03589977, 0.0148122255, -0.041853283, -0.015730346, 0.07703089, 0.02012677, -0.0043776575, 0.06830535, -0.012000092, -0.0457222, 0.026061209, -0.03659929, -0.010364093, 0.0098509705, 0.06317327, -0.04704741, 0.046655305, 0.013048596, 0.04755863, -0.012742575, -0.016440412, 0.007649656, -0.013356012, 0.01597696, 0.058001477, 0.0030329826, -0.014048707, 0.014909225, -0.01773522, -0.01211611, -0.027877785, 0.047846507, 0.015594959, 0.0033750648, -0.006324524, 0.026628269, -0.07728898, -0.013760834, 0.023116712, -0.0034718495, 0.070717536, 0.064672194, -0.029415179, 0.0018231708, 0.05141514, -7.420179E-4, -0.012390334, 0.0024279992, -0.053440176, -0.043349728, -0.0063418956, -0.05711304, -0.02058045, -0.040436253, 0.009264735, 0.022692347, 0.051134713, 0.0594607, 0.028551558, -0.04943477, -0.009508035, 0.007766992, -0.001310009, 0.024692569, -0.02381406, -0.0024580895, -0.008073478, 0.009216905, -0.04615401, -0.026680382, -0.03500885, 0.01059547, 0.013655674, 0.010846739, -0.004104248, -0.027866619, 0.028858043, -0.0455733, -0.025156641, 0.06284072, 0.0017042836, -0.0050237435, 0.029238978, -0.021257013, -0.024313185, 0.028861767, -0.04206919, -0.008594006, -0.005501852, 0.016193176, -0.056115415, -0.031438977, -0.04793088, 0.0132123865, 6.30343E-4, -0.0012315264, -0.015955245, -0.014979952, 0.04194014, -0.01709123, -0.02277207, -0.01639109, 0.042781428, -0.0038532894, -0.027745018, 0.011484061, -0.030481054, -0.0011747583, -0.060671754, -0.021363415, 0.015894445, 0.03900185, 0.0040538004, -0.0057400917, 0.024367472, 0.009846627, 0.042823616, 0.017205385, -0.011959921, 0.009294457, 0.047995407, -0.004065278, 0.017848136, 0.005215219, -0.028511852, -0.041344542, 0.018309725, -0.0027270399, -0.02390588, -0.0042151087, 0.038642008, -0.050685532, 0.005331858, -0.017088747, 0.013520112, 0.016920615, 0.0012284243, 0.014882082, -0.0018910288, 0.032537114, -0.029442478, 0.021754276, 0.017483953, 0.069456846, 0.017930653, 0.008468683, -0.034653973, 0.06616119, -0.003881635, 0.055738203, -0.030410327, 0.04218831, 0.012672624, 0.0010824713, 0.00682582, -0.0770706, 0.033619117, -0.032514777, 0.028690532, -0.033498757, -0.01162288, -0.0033775466, 0.008223463, -0.013399752, -0.036567338, -0.008832402, -0.038659383, 0.06805719, -0.012300994, -0.026012814, -0.002912622, -0.0077365916, 0.04624335, -0.0042641214, 0.031541966, -0.050124675, -0.051420104, 0.019652307, -0.019430818, -0.024239665, 0.03231066, 0.027804578, 0.017806878, 0.024727313, 0.038968347, 0.005396071, -0.01858271, 0.002114999, -0.004274668, -0.005989344, 0.021697199, -0.0018491508, -0.019587165, -0.04684888, 0.043027114, 0.023604669, 0.02989662, 0.0040054074, -0.036341507, 0.02374209, 0.0016852058, -0.023038538, 0.0738345, 0.030524483, 0.032467626, -0.015968276, 0.018850729, 0.0037742252, -0.003968803, 0.020096526, -0.046982884, -0.0335, 0.04231239, -0.008931513, -0.047173977, -0.014278881, -0.005503403, -0.017796021, -0.028843155, -0.061733905, 0.021543335, -0.050938662, 0.005762737, 0.017278595, -0.03047733, 0.0365996, -0.034445513, 0.02409759, -0.003675889, 0.038356617, -0.0072099357, -0.025593415, -0.032693457, -0.0022958505, 0.015725072, -0.0020155774, -0.012260667, -0.035970494, 0.006143314, -0.013927106, 0.046446845, -0.0041046743, -0.0053296085, 0.0019713729, -0.023511298, -0.016341766, 0.0039706645, 0.04498763, -0.0036024475, -0.0062913317, 0.004745099, -0.031621378, -0.003680775, 0.015423549, -0.07188888, 0.02104204, -0.011986443, 0.018057838, 0.013837146, -0.008651085, -0.0055043334, -0.02106003, 0.017020347, -0.020947736, 0.041498404, -0.058721162, -0.014188611, -0.029985962, -0.05178243, 0.021019705, 0.024234701, 0.0064980853, -0.013330885, -0.0015350651, -0.018820329, 0.023254909, -0.00697472, -0.009223884, 0.029708015, 0.03500637, 0.010688532, -0.0018145626, 0.019715434, 0.012704886, 0.034130342, -6.340655E-4, 0.037721314, 0.003195144, -0.0015142811, -8.6284394E-4, -0.023578921, 0.017395852, 0.021276556, -0.036515225, 0.0038620916, -0.0054671085, -0.039309576, -0.010281539, 0.00402402, -0.0071949675, -0.026055004, 0.021908762, 0.03464653, 0.050382767, 0.060939774, 0.021856645, -0.02932832, 0.038423624, 0.04741966, -0.049176678, -0.016122758, -0.019802447, -0.054958962, -0.013065697, -0.039905176, -0.010073079, -0.0410666, -0.0351106, 0.0012048484, -0.013287766, 0.0011058921, -0.008117837, -0.0030800567, -0.008643019, 0.053072896, 0.0039944923, 0.04199474, 0.007408391, 0.06060723, -0.013320338, 0.009086927, -0.009302484, 0.009596445, 0.035745908, -0.009891918, -5.977323E-4, 0.018283669, -0.019041818, 5.372805E-4, -0.023708588, 0.008083404, -4.5873E-4, 0.014539146, 0.03131117, -0.03697929, -0.02309686, 0.04194014, 0.013506463, -0.007774747, -0.014813369, -0.032882065, 0.03723987, -0.023181234, -0.007735351, 0.023539836, 0.0019729238, -0.041210532, -0.025466926, 0.01837425, 0.020344691, 0.0064033167, 0.043275278, 0.025578523, 0.01834571, 0.03797444, -0.016550226, -0.012931338, 0.01979128, -0.028268648, 0.012976318, -0.018516947, -0.026191495, -0.039393954, 0.011942394, -0.018825913, 0.029665828, 0.011660725, -0.019577857, -0.021941643, -0.024914678, -0.04172672, -0.014986951, 0.006515302, -0.035070892, -0.013462104, 0.015434717, -0.0019003351, -0.018988462, 0.038753685, -4.715164E-4, 0.0045794477, 0.010503648, 0.027901363, 0.012616398, 0.014142389, 8.9215866E-4, -0.014237933, 0.0177346, -0.017469684, -0.030824764, 0.007299818, -0.018905325, 0.043210752, -0.009092822, -0.029224088, -0.045099303, 3.9644603E-4, -0.017920105, 0.053956363, -0.051052816, 9.284918E-5, 0.040868066, -0.019167762, -0.0027789997, 0.0021243053, 0.006766028, 0.026553819, -0.0058133006, -0.022565782, 0.044302687, 0.014541318, -0.019282538, -0.016017908, 0.0028743886, -0.0128314495, 0.012240814, 0.008375, -0.008873815, -0.010647875, -0.018616213, -0.031839766, -0.004636992, -0.030256461, 0.042972516, -0.055199683, 0.017523037, -0.017358009, 0.02861112, 0.009133924, -0.022765556, -0.006089386, 0.034431864, 0.034420695, 0.01858271, 0.011969847, -0.009923249, 0.013721437, -0.049216382, -0.00724972, -0.008537549, 0.02515602, -0.0044092988, 0.035388548, 0.004458622, -0.002316014, 0.041359432, -0.006192269, -0.010182893, -0.01152338, -0.022768658, -0.008003371, 0.020434033, -0.020978913, -0.015453019, -0.004957824, 0.010574065, -0.007524719, 0.013331506, 0.0415803, 0.010919947, 0.0030583423, -0.020255351, -0.03709097, 0.033894584, -0.033599265, -0.031688385, -0.022990147, 0.052988514, 0.0056721563, -0.0042039407, 0.02108919, -0.030931477, 0.018617453, 0.0026864025, 0.02445681, -0.007865017, -0.019649826, -0.01854052, -0.011768057, 0.020523371, -0.014122654, -0.0038174214, 0.052745312, 0.012987794, -0.02272461, -4.966433E-4, 0.007348211, -0.018306004, -0.011096766, 0.06565494, 0.019056708, 0.050318245, -0.0256674, -0.009773418, 0.010095414, -0.014457872, 0.011854915, -0.032420475, -0.04171183, 0.033693567, -0.02977626, 0.00704886, 0.02484395, -0.004409919, 0.008435801, 0.048561227, -0.019955069, -0.03399385, 0.0070937234, -0.045037262, -0.011851192, 0.028253758, -0.018992804, 0.0016738832, 0.026866507, 0.017756315, 0.003291929, -0.009326098, 0.029462328, 0.010998741, -0.012320227, -0.016331838, -0.025341526, 0.0069226054, -0.009451422, 0.015122647, 0.007897589, -0.011529041, 0.037785836, -0.01830104, -0.024079598, 0.025631258, 0.0069964346, 0.009461349, 0.032695938, -0.019071598, 0.031380657, -0.011531058, -0.02044768, -0.008743217, 0.041808613, 0.046248313, -0.039989553, -0.057961777, 0.024533741, -0.019801207, 0.0012844944, 0.032887027, -0.023622973, 0.031795096, 0.032896955, 0.0115279555, -0.016860435, -0.06427513, 0.0022758422, -0.012140307, 0.07006237, -0.023003796, 0.009524631, 0.013961848, -0.023781797, 0.006233323, -0.01226439, 0.029546706, -0.029514447, 0.010099446, -0.0058672773, 2.4568485E-4, 0.0142943915, -0.03032843, 0.04182102, -0.030283762, 0.001690014, 0.011186106, -0.016727045, -0.0075337156, 0.041051704, -0.0037404902, -0.011589066, -0.0037504167, -0.01530567, 0.013778206, 0.011108244, -0.020766884, 0.033400733, -0.012342562, 0.0043196487, 0.0022029432, -0.012354505, -0.023630107, 0.020843508, -0.021213274, 0.013569513, 0.02877987, 0.011234499, 0.018332062, -0.0030227457, -0.009594932, 0.025054893, -8.251537E-4, 0.033703495, 0.0014186207, 0.012101531, -0.030546818, 0.024861323, 0.02157808, 0.008830113, -0.008155683, 0.033678677, -0.010529395, -0.05954011, 0.008639297, -0.0018345711, 0.03144518, -0.019837191, -0.004074274, -0.0017988972, -0.0064501585, 3.3351252E-4, 0.008213691, -0.031544447, -0.01041679, -0.004622877, -0.0037112914, -0.030226683, 0.0051606228, 0.02161034, -6.421309E-5, 0.021374583, 0.008623225, -0.0059504127, -0.0034479636, -0.038130786, 0.0065013426, -0.0057962392, 0.021905659, 0.03812334, -0.014285707, -0.009914253, 0.024506444, -0.046873696, 0.017324505, -0.038865358, 0.025035039, 0.007439102, -0.011576968, 0.026687207, 0.0037907436, 0.023923254, -0.027690422, 0.013445042, 0.00398094, -0.015435337, 0.016641116, 0.003754139, 0.0042275167, -0.02903052, 0.0021858818, 0.05719742, 0.0035447485, 0.008506218, 0.06090999, 0.0075268326, -0.013982943, -0.040366765, 0.013868785, -0.006232547, 0.006090627, 0.0136426445, 0.027365321, -0.0046847635, -0.011189208, -0.029995887, 0.028941179, -0.003916068, -0.030276315, 0.008708396, 0.004237443, -0.0011037206, 0.005699144, 0.022365078, 0.030298652, -0.011285993, -0.02105693, -0.023823986, 0.022821393, 0.01779478, -0.0026913658, 0.01649811, -0.009901534, -0.015772223, -0.0052215206, 0.003424388, 0.027096061, 0.01798835, -0.033259276, -0.024059745, -0.036961924, 0.0015365386, -0.06786362, -0.04431758, 0.020781774, 0.0105759455, -0.018938828, 0.021848582, 0.0062739598, -0.039828245, -0.026340395, 0.010896992, -0.006268376, 0.01701554, -0.02913475, 0.015083561, 0.027052632, 0.009966368, 8.164679E-4, 0.027082413, -0.0137422215, 0.015705839, -0.0019313559, -8.515214E-4, 0.021826245, 0.022422621, 0.010568172, 0.0051792352, 0.01010379, 0.0029178178, -0.0122395735, 0.013951612, 0.008160956, -0.02596318, 0.04743455, 0.032646306, 1.755778E-4, 0.00695223, -0.008931824, -0.0024661548, -0.004341673, -0.002001463, 0.0046221013, -0.031767797, 0.022677457, 0.0019533809, -0.030727977, 0.026052523, 0.007609406, 0.015753921, -0.018654678, -0.01794492, -0.019860767, -0.021472298, -0.0013326543, -0.0013275358, 0.012144338, 0.008364608, -0.002893001, -0.061833173, -0.013099082, 0.008191046, -0.029298538, 0.011916957, 0.013773863, 0.0101780845, 0.014444222, -0.0052899797, 0.03152211, -0.01096326, -0.0015876453, -0.044267945, -0.004270946, 0.011170285, -0.001587403, 0.0052180113, -0.005818574, -0.012781197, -0.024357544, -0.0268268, -0.03568883, -0.011182384, 0.0011288475, -1.1074432E-4, 0.008544373, 0.025474293, 0.01020802, -0.007351623, 0.027395103, 0.017429976, -0.052392915, -0.050298393, 0.014708209, 0.06275635, 0.07138758, 0.033673715, -0.032167345, -0.008569054, -0.006631737, 0.0059882584, 0.004680227, 0.012803531, 0.019332172, 0.010886329, -0.006925397, 0.0069863526, -0.05308282, -0.019482313, -0.0076546967, 0.0063988958, -0.019705663, 0.0063536833, 1.0919327E-4, -0.017862715, -0.0072461306, -0.0031991769, -0.015151807, -0.014742021, 0.016329357, 0.0045319474, 0.039994515, 0.012882324, -0.0027560445, -0.01495467, -0.003112551, 0.012013742, -0.0024034928, -0.022459071, 0.025920993, -0.02855404, 0.0030847099, 0.026176605, -0.011665998, -0.008120009, 6.402696E-4, 0.016540298, 0.030653527, -0.0289722, 0.027561374, -0.0068351263, -0.015655585, 0.00830055, -0.0151977185, 0.011839095, 0.0074358834, -0.009467553, -0.037999257, 0.054924212, -0.010224772, 0.021292688, -0.016226368, -0.04068442, -0.032668643, -0.0064042476, -0.024657825, 0.015923606]
                	}, {
                		"object": "embedding",
                		"index": 1,
                		"embedding": [0.038977705, -0.108584724, 0.0717131, -0.052641924, 0.030436935, -0.0828966, 0.05476319, 0.14218077, -0.024888217, -0.03493514, -0.014358757, 0.089437604, -0.012834569, -0.09888459, -0.13215664, -0.068062894, -0.061283946, 0.071870044, 0.027599294, 0.07601133, -0.18827157, -0.012156168, -0.04727546, 0.08586334, 0.035540134, 0.036969077, 0.0089889765, 0.050206766, -0.06748575, 0.0352389, -0.011079495, -0.04355438, -0.033379626, -0.01359081, 0.029502867, 0.068032525, -0.04013706, -0.008453438, -0.07975267, -0.038810633, -0.011768871, -0.009172341, 0.009262521, -0.02105702, -0.015364652, 0.040142126, -2.9237074E-4, -0.024994535, -0.026019098, -0.023098554, -0.030521734, -0.00657937, -0.030819166, 0.042597532, 0.01942462, 0.0076231556, 0.010404158, -0.037838597, -0.02708416, -0.031305186, 0.020978946, 0.022911234, -0.04654137, 0.06508603, -0.020760855, 0.030839419, 0.005073455, -0.107248165, 0.020958615, -0.07283196, 5.219324E-4, -0.011762543, -0.004971568, 0.050024506, -0.056464262, 0.0020908148, 0.08554945, 0.0043195086, -0.011464477, -0.041984946, 0.040726867, 0.05904117, -0.021924008, -0.01711318, -0.04009656, 0.02720187, -0.030738166, 0.13990256, -0.030750822, 0.037438642, 0.070462614, -0.06865017, 0.037332326, 0.06155227, 0.035226244, 9.040079E-4, -0.023013756, 0.0033790339, 0.016409466, 0.06461013, 0.065875806, 0.0017985231, -0.075980954, 0.040926844, 0.01110819, 0.05971451, 0.057856504, -0.08276497, -0.049791623, 0.06646815, 0.014443637, 0.013657258, 0.04513394, 0.025713436, 0.12075544, -0.014260588, -0.0027338562, -0.0059863226, 0.013743957, -0.040759772, -0.02166328, 0.05950188, -0.035471786, 0.022273967, 0.017587809, -0.094328165, -0.033537835, 0.076001205, -0.0019478726, -0.06702504, -0.0022358135, 0.045645274, -0.009746957, 0.034497216, 0.015586778, -1.9048397E-4, 0.01235741, 0.057117343, 0.0036479896, 0.053421576, -0.005472459, 0.05085479, -0.03653242, -0.015419076, 0.05857034, -0.074310265, 0.005465181, -0.0062848637, -0.00536456, 0.024698367, 0.037097543, 0.021787316, -0.03202662, 0.029459834, 0.021365846, 0.014783075, 0.044759303, 0.01146954, -0.02810303, 0.010343416, -0.04180775, -0.015744988, 0.002794292, -0.032119013, -0.07949446, 0.012665602, 0.012158699, 0.0062593915, -0.0036476732, 0.030780563, 0.008994514, 5.913863E-4, -0.0029545038, -0.010697478, -0.0038957451, 0.0129541755, -0.0111189475, 0.048525948, 0.028834589, 0.08854657, -0.012795966, 0.031905115, 0.007786428, 0.07123721, 0.023399785, -0.010846196, 0.030609064, 0.019043334, 0.008363733, -0.008725558, 0.0035101892, -0.008125628, -0.025641294, 0.028206816, -0.051437, 0.011061597, -0.0074233375, -0.046318613, 0.022944143, -0.018385183, 0.0010226648, -0.0028754536, 0.09830745, 0.012177051, -0.023392824, -0.02879915, -0.053527895, 0.007862369, -0.04469349, -0.032808807, -0.028313132, -0.0024361066, -0.03429471, 0.020393176, -0.07992986, -0.05391772, -0.010980989, -0.037142478, 0.028963687, 0.04445554, -0.05919305, -0.025291968, -0.014379324, 0.0637191, 0.035479378, -0.01491344, 0.038400557, -0.0028556774, 0.022653116, -0.03222102, -0.0033600486, 0.028039746, 0.03135328, -0.026384246, -0.009231195, -0.007959508, 0.017638436, 0.03384413, -0.0075926217, 0.012037194, 0.058226075, 0.031041928, -0.01496992, 0.0068298946, -0.034231424, -0.011757481, 0.039975055, -0.026129844, -0.016033562, -0.0068004676, 0.007066259, -0.06343559, -0.002840173, 0.0020503923, 0.016482877, 0.038871385, 0.032340508, -0.043832827, 0.036380537, 0.027262622, 0.0033818816, -0.04331264, 0.029854724, 0.076760605, 0.022222709, 0.0076674544, -9.296377E-4, -0.0042843074, -0.025809627, 0.011709701, -0.0024407932, -0.010773419, -0.007662392, 0.018235201, -0.03551735, -0.032634143, 0.017625147, 0.024890749, -0.0112841185, -0.022817574, 0.031765893, 0.00492193, 0.0065008583, 0.024131345, -0.018077625, -0.00832426, 0.011216405, 0.020946275, -0.0053616925, -0.029697778, 0.04385055, 0.038560033, -0.019761814, -0.006304956, -0.018949674, 0.039058708, 0.027025308, -0.0019409115, -0.02289921, 0.0059543643, 0.0034793383, 0.032418977, 0.002066846, -0.011140148, 0.03251011, 0.030657161, 0.010390711, -0.0057607163, 0.05958794, 0.039473847, -0.017292907, -0.03441115, 0.012475751, -0.010719944, 0.012340324, -7.216716E-4, -0.063253336, 0.03649192, 0.0066631422, 0.07199155, -0.01118856, -0.0152146695, -0.0031964602, 0.049978945, 3.1879168E-5, -0.011480615, 0.006331219, -0.09069315, -8.245868E-4, -0.016803091, 0.014103408, -0.038390428, 0.014231241, 0.026379181, -0.0065890998, -0.0057352446, -0.04940686, -0.012037827, 0.00907884, -0.0110949, -0.028024558, 0.03683112, -0.0052069835, -0.032499984, 0.01937241, 0.019861592, 0.012429553, -0.011396447, 0.002994427, -0.009209045, -0.030006604, 0.0072739087, -0.04699195, 0.02038748, -0.011806525, 0.048556324, 0.03612234, -0.013084541, -0.002459047, 0.03449975, -0.04124832, 0.019066116, -0.021301297, 0.0057464773, -0.013802177, -0.010086158, 0.005441766, -0.007072515, -0.04183306, -0.0319279, 0.028583985, -0.083504125, -0.0062502157, 0.0021605059, -4.5279498E-4, -0.022320164, -0.0023598496, -0.0035033862, -4.4963078E-4, -0.015491853, -0.061921842, -0.009983005, -0.020372292, 0.0045814244, -0.016493633, -0.029971166, 0.063972235, -0.02579444, 0.0011957457, -0.027930899, 0.010701275, -0.0038938466, -0.009776068, -0.032279752, 0.032780964, -0.013512338, 0.047434937, -0.033542898, 0.012322842, 0.048860084, 0.009440664, 0.043508817, -0.026751291, 0.017689379, 0.01321617, 0.0063392874, 9.742527E-4, 0.029556023, 0.04111796, -0.01754098, -0.011578388, 0.029578807, 0.02424399, -0.026536128, -0.033671994, -0.018262414, -0.0015159613, 0.03238101, 0.022754291, -0.014022089, 0.00139857, -0.052530542, -0.023160573, 0.0071719433, 0.03397323, 0.050146013, -0.03834993, -0.01747643, -0.007816488, -0.05842858, -0.0027488861, 4.1387547E-4, -0.029801566, -0.0028267251, -0.0132313585, 0.02943452, -2.604125E-4, -0.010873407, 0.022921994, -0.022434076, 0.03480604, 0.047283057, -0.02885231, -0.05804888, 0.02370165, -0.042526655, 0.006011636, 0.030173672, -0.015034945, -0.006352735, 0.008675722, -0.018154198, 0.0012099845, -0.04681476, 0.0130472025, -0.029386425, 0.012836468, -0.0169613, -0.026810778, 0.068619795, -0.007019113, 0.011260703, -0.011584084, -0.012931393, 0.032783493, 0.06544042, 0.05477332, -0.009969399, 0.037719622, 0.0030271763, 0.01878134, -0.021730362, -0.04930054, -0.01295995, -0.022202456, -0.008808776, -0.025556494, 0.0033272994, -0.039448533, 0.031203931, -0.037668996, 0.033370767, 0.003972635, 0.02228093, -0.018759191, 0.05238879, 0.0056233904, 0.03040909, 0.010807592, 0.06189653, 0.0072605405, 0.017503008, -0.019266093, 0.032467075, 0.008103796, -0.06763763, 0.005000679, 0.0068743513, 0.0053867097, 0.0027876475, -0.05996258, -0.013275024, -0.03477946, -0.025898226, 0.04436441, -0.03632485, -0.027827114, -0.0044697286, -0.012859724, 0.039413095, -0.0015548808, -0.030330615, -0.010530409, -0.012588396, 0.05085479, 0.032340508, -0.039438408, -0.07002216, -0.02695886, 0.0132427495, 0.012046687, 0.008184799, 0.06743512, 0.00612966, 0.0045792093, 0.041235667, -0.015782325, -0.015462741, 8.593928E-4, -0.021980964, 0.029915476, 0.006830844, -0.029463628, 0.011038063, -0.012524479, 0.0023084315, 0.035922363, 0.005978096, 0.032244317, -0.029543366, -0.035813518, -0.00320975, -0.016714493, -0.024035154, 0.0020604385, 0.024144001, -0.038268927, 0.00467192, 0.02603998, 0.083767384, -0.016676523, -0.039068833, 0.002234706, 0.03044706, -0.0015884212, 0.0090653915, 0.03271515, -0.009313543, 0.0042521907, -0.014217951, -0.01083164, -0.008303455, -0.019574918, 0.040562328, 0.034044106, 0.0072560315, -0.00912646, -0.010346887, 0.002500023, 0.066827595, 0.010086316, -0.0033530872, 0.047255214, 0.036972873, 0.035261683, -0.014651445, 0.018499093, 0.048136123, -0.005089197, -0.044328973, 0.020821607, 0.0081482725, 0.0088945255, -0.019043334, -0.021293703, 0.02396934, -0.0021858194, -0.0034394697, -0.032239255, -0.027472725, -0.0014056894, -0.013021889, -0.0033739712, -0.034912355, 0.019243311, 0.022626458, 0.0046013584, -0.002973148, 0.010046289, -0.009181201, -0.017810566, -0.02573005, -0.008029438, 0.019534416, -0.01043232, 0.0022497359, -0.009444461, 0.022039186, -0.023252966, -0.0069884206, -0.042093795, -0.033175852, 0.028181503, 0.0014463492, -0.01270199, -0.0038172735, 0.033031568, -0.026443098, -0.034160547, -0.019376207, -0.012074532, -0.016068999, 0.019569853, 0.0023316883, -0.03400107, 0.004376701, -0.008758466, 0.041104037, 0.025202105, 0.018802855, -0.02731578, 0.010967067, -0.028406791, -0.03129, 0.01948379, -0.0034274457, -0.0572591, -0.017704252, 0.046318613, 0.0060557765, 0.0133566605, 0.05165976, 0.020103969, -0.007085719, 0.027520819, 0.019527454, -0.0034355589, 0.0040799007, -0.03163173, 0.016185125, -0.036724806, 0.02183288, 0.023668109, -0.034757946, 0.023460537, -0.031507693, 0.013211978, 0.0113572115, 0.011051867, 0.014058793, -0.050029572, 0.0062946724, 0.040572453, -0.039380185, -0.012199834, -0.0010593693, -0.028839653, 0.002484281, -0.02738919, -0.010606349, -0.0067894817, -0.019107409, 0.048308253, 0.006236451, -0.0036191957, -0.024040373, 0.004055853, 0.029153539, -0.030378712, 0.010916144, -0.022806184, 0.013372482, 0.03908402, -0.04702739, -0.03576289, 0.002745623, 0.021448115, -0.01038106, 0.018813414, -0.0060306215, 0.026661428, 0.006969435, 7.7740086E-4, -0.012527643, -0.020101437, -0.018575035, -0.008951164, -0.06544042, 0.012861782, 0.05312794, -0.005877158, -0.035919834, 0.007187131, 0.010567115, 0.020427981, 0.022680882, -0.014500828, -0.027308188, 0.026774071, 0.022172082, -0.024292085, -0.012516253, 0.0010496753, -0.016261382, -0.028748523, -0.016751198, -0.0022293269, 0.013711049, 0.0033318873, -0.037813284, -0.0037120644, 0.03142669, 0.03882076, 0.014730549, -0.0046678064, -0.059046235, 0.047943737, 0.042107712, -0.005123291, 0.016323399, 0.033317607, -0.024087045, 0.005469611, -0.019085102, 0.03399095, -0.018322533, 0.02309982, 0.032143064, 0.023177026, 0.029262388, 0.0103722, 0.054758128, -0.020421654, -0.024423083, 0.02162531, -0.009445727, -0.013988865, 0.0023206137, -0.01174866, -0.008146512, -0.0048570246, -0.018419357, 0.0052674194, 0.074831724, 2.2655568E-4, 0.009138168, -0.022127783, -0.0033261916, -0.0045023197, -0.02825238, -0.0046935948, -5.781412E-4, -0.016967628, 0.034750354, 0.019564793, -0.00695488, -0.0094982525, -0.009775435, -0.01118856, 0.0074497582, 0.025951384, -0.0077047916, 0.021978432, 0.010765192, 0.010257024, 0.028019497, -0.02898394, 0.015704487, -0.01627657, 0.03585402, -0.0472261, -0.007218457, 0.0018852217, -0.0038228107, 0.026789261, -0.032462012, -0.010801896, -0.00445193, -0.014057843, -0.012351082, -0.025381831, -0.001174862, 0.010478042, -0.031750705, -0.003001863, -0.003520789, -0.01518556, 0.005873994, 0.00303038, 0.018135529, -0.0016104123, 0.009237523, 0.001328325, -0.018329494, -0.010124444, 0.008335098, 0.036135, 0.008230046, -0.030472374, -0.0684831, 0.014928628, -0.04201532, 0.019786285, -0.023574447, 0.0026591816, -0.028348573, -0.0066049206, -0.01516784, -0.027138585, 0.0049042506, -0.017377706, -0.016006982, -0.01272319, 0.006736551, 0.030586284, -0.03380616, -0.009068398, 0.01650186, 0.014216052, 0.016676523, 0.019345196, -0.002552232, 0.02502238, -0.016523376, -0.034187127, -0.003167508, -0.0064459997, 0.033423927, -0.013992167, 0.006146114, -0.0039890883, 0.014738776, -0.008493939, -0.039848484, -0.025670404, -0.018281398, -0.038344868, 0.013800912, -0.044101153, -0.016688548, 0.0030438774, -0.016132284, 0.0061397855, -0.034623787, -0.024952767, 0.001093859, -0.019079326, 0.0038096793, 0.018947143, -0.002295933, 0.00906729, -0.0045355037, -0.021120304, -0.025523586, -0.017665965, 0.014884962, -0.020147003, -0.015057251, -0.0027889921, 0.012706736, 0.012351398, -0.08049182, 0.004012662, -0.017664699, 0.017168237, 0.0013030116, 0.04677932, -0.028546015, -0.009397552, -0.006487213, 0.044895995, 0.028915593, -0.007569997, 0.052646987, 0.005345457, 0.0051240823, 0.017880496, 0.037823405, -0.00407911, 0.011592311, -0.024912266, -0.011986252, 0.01955973, -0.020743135, 0.0030920422, -0.022906173, -0.040461075, 0.010977668, -0.0043517044, 0.019845773, -0.046551496, -0.017488137, -3.990038E-4, 0.008461349, -0.0026737368, -0.021200042, -0.018829435, -0.0058554835, -0.007152009, 0.01402114, 0.017182793, -0.016822075, 0.03797529, -0.00805127, -0.007735168, 0.032846775, -0.025733687, -0.003319547, -0.055456784, 0.033831473, 6.549864E-4, 0.021903126, 0.014415555, -0.019349627, 0.037236135, 0.008444578, -0.016581597, -0.017918782, -0.0023180032, 8.3977485E-4, -0.0041463487, -0.010353847, -0.015943697, 0.03180386, -0.018919298, -0.020163298, -0.013790154, 0.029292762, -8.885033E-4, -0.011569528, -0.0065955864, -0.004110277, -0.02800937, 0.06576949, -0.0060679587, -3.686276E-4, 0.022250554, -0.008395316, -0.024950236, -0.03718551, 0.021408899, -0.01009122, 0.006592106, 0.010216839, 0.0020275312, -0.014161629, 0.026558906, -0.0055082142, -0.0027987221, -0.028467543, 0.009878587, 0.023218794, 0.03846637, 0.04921954, -0.0015620001, -0.007272564, 0.010888595, 0.03705641, 0.006845399, 0.008628101, -0.007371287, 0.0147590265, -0.0013276923, 0.013038975, 0.0068218256, 0.026314316, 0.005097384, -0.0023782018, -0.020793129, -0.010523764, -0.016656272, 0.011599587, 0.023921242, 0.017513134, -0.017996622, 0.024898343, -0.01942557, 0.028540954, 0.006155607, 0.020819075, 0.0128440615, -0.029429456, -0.008975845, 0.02314665, -0.0013922417, 0.003508449, -0.032610096, -0.029064942, -0.016200788, -0.009917823, 7.2014885E-4, -0.011416381, 0.025460303, 0.0065840376, 0.0034733263, -0.016556283, 0.01779538, -0.0077959206, 0.0041417605, 0.019428099, 0.0024751842, 0.018590223, 0.042734224, -0.029588932, 0.02647031, -0.0033470755, 0.025414739, 0.00176522, -0.0074725407, -0.030004075, -0.015848773, 0.014081891, -0.036380537, 0.0015421548]
                	}]
                """;
        ConfigurableApplicationContext context = SpringApplication.run(App.class, args);
        ElasticsearchClient elasticsearchClient = context.getBean(ElasticsearchClient.class);
        ObjectMapper objectMapper = context.getBean(ObjectMapper.class);

        try {
            // Define index name
            String indexName = "test_embeddings_index";

            // Parse JSON and extract embedding vectors
            JsonNode rootNode = objectMapper.readTree(text);

            System.out.println("Starting to store vector data...");

            // Method 1: Store vectors individually
//            storeVectorsIndividually(elasticsearchClient, rootNode, indexName);

            // Method 2: Bulk storage (recommended, more efficient)
            storeBulkVectors(elasticsearchClient, rootNode, indexName);

        } catch (Exception e) {
            e.printStackTrace();
        } finally {
            context.close();
        }

    }

    // Method 1: Store vectors individually
    private static void storeVectorsIndividually(ElasticsearchClient elasticsearchClient, JsonNode rootNode, String indexName) {
        List<Mono<Boolean>> storeOperations = new ArrayList<>();

        for (int i = 0; i < rootNode.size(); i++) {
            JsonNode embeddingNode = rootNode.get(i);
            JsonNode embeddingArray = embeddingNode.get("embedding");

            // Convert JSON array to List<Float>
            List<Float> vector = new ArrayList<>();
            for (JsonNode value : embeddingArray) {
                vector.add(value.floatValue());
            }

            // Build vector document
            VectorDocumentReq document = new VectorDocumentReq();
            document.setContent("Vector example " + i);
            document.setVector(vector);
            document.setFileName("sample_file_" + i + ".txt");
            document.setId("vector_" + i);

            System.out.println("Preparing to store vector " + i + ", dimensions: " + vector.size());

            // Store to Elasticsearch
            Mono<Boolean> storeOperation = elasticsearchClient.storeVectorDocument(indexName, document);
            storeOperations.add(storeOperation);
        }

        // Wait for all operations to complete
        Mono.when(storeOperations)
                .then(Mono.just(true))
                .doOnSuccess(success -> System.out.println("All vectors stored successfully (individual mode)"))
                .doOnError(error -> System.err.println("Storage failed: " + error.getMessage()))
                .block();
    }

    // Method 2: Bulk store vectors (more efficient)
    private static void storeBulkVectors(ElasticsearchClient elasticsearchClient, JsonNode rootNode, String indexName) {
        // Build vector document list
        List<VectorDocumentReq> documents = new ArrayList<>();

        for (int i = 0; i < rootNode.size(); i++) {
            JsonNode embeddingNode = rootNode.get(i);
            JsonNode embeddingArray = embeddingNode.get("embedding");

            // Convert JSON array to List<Float>
            List<Float> vector = new ArrayList<>();
            for (JsonNode value : embeddingArray) {
                vector.add(value.floatValue());
            }

            // Build vector document
            VectorDocumentReq document = new VectorDocumentReq();
            document.setContent("Vector example " + i + " (bulk)");
            document.setVector(vector);
            document.setFileName("sample_file_" + i + ".txt");
            document.setId("vector_bulk_" + i);

            documents.add(document);
        }

        System.out.println("Preparing to bulk store " + documents.size() + " vectors");

        // Bulk store to Elasticsearch
        elasticsearchClient.storeBulkVectorDocuments(indexName, documents)
                .doOnSuccess(success -> System.out.println("Bulk storage operation completed"))
                .doOnError(error -> System.err.println("Bulk storage failed: " + error.getMessage()))
                .block();
    }
}